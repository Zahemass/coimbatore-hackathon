<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Dude Code Tester — AI Automation UI</title>

  <!-- Montserrat -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;700&display=swap" rel="stylesheet">

  <!-- Bootstrap & Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

  <!-- Prism -->
  <link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-tomorrow.css" rel="stylesheet" />

  <!-- styles -->
  <link href="style.css" rel="stylesheet">
</head>
<body>
  <div class="container-app">
    <div class="header">
      <div class="logo"></div>
      <div class="header-texts">
        <div class="title">Dude Code Tester — AI Automation</div>
        <div class="subtitle">Interactive, dark-mode GUI for your API tests</div>
      </div>
    </div>

    <div class="layout-grid">
      <!-- Sidebar -->
      <aside class="sidebar card-style">
        <div class="sidebar-top mb-2">
          <div class="routes-title"><i class="bi bi-diagram-3"></i> Routes</div>
          <div class="muted-note tiny">Click a route to view code</div>
        </div>

        <div id="apiList" class="routes-list"></div>

        <div class="sidebar-bottom mt-2">
          <button id="refreshRoutesBtn" class="btn btn-sm btn-outline-light w-100"><i class="bi bi-arrow-clockwise"></i> Refresh Routes</button>
        </div>
      </aside>

      <!-- Main workspace -->
      <main class="workspace">
        <!-- Request row -->
        <div class="card-style request-row d-flex gap-2 align-items-center">
          <div style="min-width:120px">
            <select id="methodSelect" class="method-select w-100">
              <option>GET</option>
              <option selected>POST</option>
              <option>PUT</option>
              <option>DELETE</option>
            </select>
          </div>

          <div style="width:220px">
            <select id="baseSelect" class="method-select w-100">
              <option value="http://localhost:3000">localhost:3000</option>
              <option value="http://localhost:4000">localhost:4000</option>
              <option value="http://localhost:5173">localhost:5173</option>
            </select>
          </div>

          <input id="url" class="url-input flex-fill" placeholder="http://localhost:3000/signup" />

          <div class="controls d-flex align-items-center gap-2">
            <button id="sendBtn" class="btn btn-primary send-btn">
              <i class="bi bi-lightning-charge-fill"></i>
              <span id="sendText">Send</span>
              <span id="spinnerDots" class="spinner-dots"><span class="dot"></span><span class="dot"></span><span class="dot"></span></span>
            </button>
          </div>
        </div>

        <!-- Request tabs -->
        <ul class="nav nav-tabs mt-3" id="requestTabs" role="tablist">
          <li class="nav-item" role="presentation"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#paramsTab" type="button">Params</button></li>
          <li class="nav-item" role="presentation"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#authTab" type="button">Auth</button></li>
          <li class="nav-item" role="presentation"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#headersTab" type="button">Headers</button></li>
          <li class="nav-item" role="presentation"><button class="nav-link active" data-bs-toggle="tab" data-bs-target="#bodyTab" type="button">Body</button></li>
        </ul>

        <div class="tab-content card-style request-tabs-content">
          <div class="tab-pane fade" id="paramsTab">
            <textarea id="paramsInput" class="json-input" placeholder="e.g. foo=1&bar=2"></textarea>
          </div>
          <div class="tab-pane fade" id="authTab">
            <textarea id="authInput" class="json-input" placeholder="Authorization: Bearer ..."></textarea>
          </div>
          <div class="tab-pane fade" id="headersTab">
            <textarea id="headersInput" class="json-input" placeholder="Key: Value (each header on new line)"></textarea>
            <div class="muted-note tiny mt-1">Enter each header on its own line (Key: Value)</div>
          </div>
          <div class="tab-pane fade show active" id="bodyTab">
            <textarea id="bodyInput" class="json-input large" placeholder='{"email":"test@example.com","password":"Passw0rd!"}'></textarea>
            <div class="d-flex gap-2 mt-2">
              <button id="formatBtn" class="btn btn-outline-light small"><i class="bi bi-code-slash"></i> Format</button>
              <button id="clearBtn" class="btn btn-outline-light small"><i class="bi bi-x-lg"></i> Clear</button>
              <button id="aiFillBtn" class="btn btn-outline-light small ms-auto"><i class="bi bi-robot"></i> AI Suggestions</button>
            </div>
          </div>
        </div>

        <!-- Response / AI / History / Timeline -->
        <ul class="nav nav-tabs mt-3" id="respTabs" role="tablist">
          <li class="nav-item" role="presentation"><button class="nav-link active" data-bs-toggle="tab" data-bs-target="#respTab" type="button">Response</button></li>
          <li class="nav-item" role="presentation"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#aiTab" type="button">AI</button></li>
          <li class="nav-item" role="presentation"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#historyTab" type="button">History</button></li>
          <li class="nav-item" role="presentation"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#timelineTab" type="button">Timeline</button></li>
        </ul>

        <div class="tab-content card-style response-tabs-content flex-fill">
          <div class="tab-pane fade show active d-flex flex-column" id="respTab">
            <div class="response-meta d-flex align-items-center gap-2">
              <div id="statusBadge" class="status-badge">—</div>
              <div id="metaTime" class="meta-pill">— ms</div>
              <div id="metaSize" class="meta-pill">— bytes</div>
              <div id="metaUrl" class="meta-pill flex-fill">—</div>
              <div class="ms-auto tiny muted-note">Response</div>
            </div>
            <div id="responseBox" class="response-box">— no response yet —</div>

            <div class="d-flex gap-2 mt-3">
              <button id="copyBtn" class="btn btn-outline-light small"><i class="bi bi-clipboard"></i> Copy</button>
              <button id="prettyBtn" class="btn btn-outline-light small"><i class="bi bi-braces"></i> Pretty</button>
              <button id="saveBtn" class="btn btn-outline-light small ms-auto"><i class="bi bi-save"></i> Save result</button>
            </div>
          </div>

          <div class="tab-pane fade" id="aiTab">
            <div id="aiPanel" class="ai-panel">No suggestions yet — press <b>AI Suggestions</b>.</div>
          </div>

          <div class="tab-pane fade" id="historyTab">
            <div class="d-flex gap-2 mb-2">
              <button id="historySaveBtn" class="btn btn-outline-light small"><i class="bi bi-clock-history"></i> Save to history</button>
              <div class="tiny ms-auto muted-note">Shortcuts: <span class="kbd">S</span> = Send</div>
            </div>
            <div id="history" class="history">No saved history</div>
          </div>

          <div class="tab-pane fade" id="timelineTab">
            <div id="timeline" class="history">No timeline yet — send a request to populate.</div>
          </div>
        </div>
      </main>

      <!-- Code snippet / editor -->
      <aside class="snippet-side card-style">
        <div class="d-flex align-items-center justify-content-between mb-2">
          <h6 class="m-0">API Code Snippet</h6>
          <div class="d-flex gap-2">
            <button id="saveCodeBtn" class="btn btn-sm btn-outline-light"><i class="bi bi-save"></i></button>
            <button id="rollbackBtn" class="btn btn-sm btn-outline-light"><i class="bi bi-arrow-counterclockwise"></i></button>
            <button id="expandSnippet" class="btn btn-sm btn-outline-light"><i class="bi bi-arrows-fullscreen"></i></button>
          </div>
        </div>
        <div id="monacoContainer" class="monaco-container"></div>
        <div id="codeStatus" class="tiny muted-note mt-2">—</div>
      </aside>
    </div>
  </div>

  <!-- fullscreen editor -->
  <div id="fullscreenEditor" class="fullscreen-editor">
    <div class="editor-header">
      <div class="d-flex gap-2 w-100">
        <button id="closeEditor" class="btn btn-sm btn-outline-light"><i class="bi bi-x-lg"></i></button>
        <div id="fullscreenFileLabel" class="muted-note tiny ms-2"></div>
        <div class="ms-auto d-flex gap-2">
          <button id="fullscreenSaveBtn" class="btn btn-sm btn-outline-light"><i class="bi bi-save"></i> Save</button>
          <button id="fullscreenRollbackBtn" class="btn btn-sm btn-outline-light"><i class="bi bi-arrow-counterclockwise"></i> Rollback</button>
        </div>
      </div>
    </div>
    <div id="monacoFullscreen" class="monaco-container fullscreen-monaco"></div>
  </div>

  <!-- deps -->
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.js"></script>

  <!-- Monaco loader (require) AFTER axios to avoid anonymous define conflict -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.45.0/min/vs/loader.min.js"></script>

  <!-- app -->
  <script src="app.js"></script>
</body>
</html>
